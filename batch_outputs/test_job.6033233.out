SLURM_JOBID=6033233
SLURM_JOB_NODELIST=jagupard34
SLURM_NNODES=1
SLURMTMPDIR=
working directory = /sailhome/fongsu/superhf
[2023-04-21 11:21:35,771] [WARNING] [runner.py:190:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
Detected CUDA_VISIBLE_DEVICES=0,1,2,3: setting --include=localhost:0,1,2,3
[2023-04-21 11:21:35,803] [INFO] [runner.py:540:main] cmd = /sailhome/fongsu/rm/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMSwgMiwgM119 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None src/reward_modelling/reward_model.py --model_name_or_path=EleutherAI/gpt-neo-1.3B --output_dir=/nlp/scr/fongsu/reward_model_HH/train_first_half/ --logging_steps=10 --per_device_train_batch_size=16 --per_device_eval_batch_size=16 --num_train_epochs=1 --do_eval=True --evaluation_strategy=steps --eval_steps=1000 --save_total_limit=5 --save_strategy=steps --save_steps=1000 --learning_rate=1e-5 --weight_decay=0.001 --report_to=wandb --gradient_checkpointing=True --ddp_find_unused_parameters=False --push_to_hub=True
[2023-04-21 11:21:41,265] [INFO] [launch.py:222:main] 0 NCCL_P2P_DISABLE=1
[2023-04-21 11:21:41,265] [INFO] [launch.py:229:main] WORLD INFO DICT: {'localhost': [0, 1, 2, 3]}
[2023-04-21 11:21:41,265] [INFO] [launch.py:235:main] nnodes=1, num_local_procs=4, node_rank=0
[2023-04-21 11:21:41,265] [INFO] [launch.py:246:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3]})
[2023-04-21 11:21:41,265] [INFO] [launch.py:247:main] dist_world_size=4
[2023-04-21 11:21:41,265] [INFO] [launch.py:249:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3
04/21/2023 11:22:48 - WARNING - datasets.builder - Found cached dataset webgpt_comparisons (/nlp/scr/fongsu/.cache/openai___webgpt_comparisons/default/0.0.0/8b5d5879cdc98c4c0099af6053dffe8d504588d43d3b11f1b1ec223ab1e8db0a)
04/21/2023 11:22:48 - WARNING - datasets.builder - Found cached dataset webgpt_comparisons (/nlp/scr/fongsu/.cache/openai___webgpt_comparisons/default/0.0.0/8b5d5879cdc98c4c0099af6053dffe8d504588d43d3b11f1b1ec223ab1e8db0a)
04/21/2023 11:22:48 - WARNING - datasets.builder - Found cached dataset webgpt_comparisons (/nlp/scr/fongsu/.cache/openai___webgpt_comparisons/default/0.0.0/8b5d5879cdc98c4c0099af6053dffe8d504588d43d3b11f1b1ec223ab1e8db0a)
04/21/2023 11:22:48 - WARNING - datasets.builder - Found cached dataset webgpt_comparisons (/nlp/scr/fongsu/.cache/openai___webgpt_comparisons/default/0.0.0/8b5d5879cdc98c4c0099af6053dffe8d504588d43d3b11f1b1ec223ab1e8db0a)
04/21/2023 11:22:57 - WARNING - datasets.builder - Using custom data configuration Anthropic--hh-rlhf-c8cd8dc58ab67414
04/21/2023 11:22:57 - WARNING - datasets.builder - Found cached dataset json (/nlp/scr/fongsu/.cache/Anthropic___json/Anthropic--hh-rlhf-c8cd8dc58ab67414/0.0.0/0f7e3662623656454fcd2b650f34e886a7db4b9104504885bd462096cc7a9f51)
04/21/2023 11:22:57 - WARNING - datasets.builder - Using custom data configuration Anthropic--hh-rlhf-c8cd8dc58ab67414
04/21/2023 11:22:57 - WARNING - datasets.builder - Using custom data configuration Anthropic--hh-rlhf-c8cd8dc58ab67414
04/21/2023 11:22:57 - WARNING - datasets.builder - Found cached dataset json (/nlp/scr/fongsu/.cache/Anthropic___json/Anthropic--hh-rlhf-c8cd8dc58ab67414/0.0.0/0f7e3662623656454fcd2b650f34e886a7db4b9104504885bd462096cc7a9f51)
04/21/2023 11:22:57 - WARNING - datasets.builder - Found cached dataset json (/nlp/scr/fongsu/.cache/Anthropic___json/Anthropic--hh-rlhf-c8cd8dc58ab67414/0.0.0/0f7e3662623656454fcd2b650f34e886a7db4b9104504885bd462096cc7a9f51)
04/21/2023 11:22:57 - WARNING - datasets.builder - Using custom data configuration Anthropic--hh-rlhf-c8cd8dc58ab67414
04/21/2023 11:22:57 - WARNING - datasets.builder - Found cached dataset json (/nlp/scr/fongsu/.cache/Anthropic___json/Anthropic--hh-rlhf-c8cd8dc58ab67414/0.0.0/0f7e3662623656454fcd2b650f34e886a7db4b9104504885bd462096cc7a9f51)
04/21/2023 11:23:01 - WARNING - datasets.builder - Found cached dataset summarize_from_feedback (/nlp/scr/fongsu/.cache/openai___summarize_from_feedback/comparisons/0.0.0/483f970ceb55b926b0a087ef4f678ab1b089bc8174a107a452c6152e88af7ff0)
04/21/2023 11:23:01 - WARNING - datasets.builder - Found cached dataset summarize_from_feedback (/nlp/scr/fongsu/.cache/openai___summarize_from_feedback/comparisons/0.0.0/483f970ceb55b926b0a087ef4f678ab1b089bc8174a107a452c6152e88af7ff0)
04/21/2023 11:23:01 - WARNING - datasets.builder - Found cached dataset summarize_from_feedback (/nlp/scr/fongsu/.cache/openai___summarize_from_feedback/comparisons/0.0.0/483f970ceb55b926b0a087ef4f678ab1b089bc8174a107a452c6152e88af7ff0)
04/21/2023 11:23:01 - WARNING - datasets.builder - Found cached dataset summarize_from_feedback (/nlp/scr/fongsu/.cache/openai___summarize_from_feedback/comparisons/0.0.0/483f970ceb55b926b0a087ef4f678ab1b089bc8174a107a452c6152e88af7ff0)
04/21/2023 11:23:08 - WARNING - datasets.builder - Using custom data configuration Dahoas--synthetic-instruct-gptj-pairwise-0b2fd7bd9ea121cb
04/21/2023 11:23:08 - WARNING - datasets.builder - Found cached dataset parquet (/nlp/scr/fongsu/.cache/Dahoas___parquet/Dahoas--synthetic-instruct-gptj-pairwise-0b2fd7bd9ea121cb/0.0.0/2a3b91fbd88a2c90d1dbbb32b460cf621d31bd5b05b934492fdef7d8d6f236ec)
04/21/2023 11:23:08 - WARNING - datasets.builder - Using custom data configuration Dahoas--synthetic-instruct-gptj-pairwise-0b2fd7bd9ea121cb
04/21/2023 11:23:08 - WARNING - datasets.builder - Found cached dataset parquet (/nlp/scr/fongsu/.cache/Dahoas___parquet/Dahoas--synthetic-instruct-gptj-pairwise-0b2fd7bd9ea121cb/0.0.0/2a3b91fbd88a2c90d1dbbb32b460cf621d31bd5b05b934492fdef7d8d6f236ec)
04/21/2023 11:23:08 - WARNING - datasets.builder - Using custom data configuration Dahoas--synthetic-instruct-gptj-pairwise-0b2fd7bd9ea121cb
04/21/2023 11:23:08 - WARNING - datasets.builder - Found cached dataset parquet (/nlp/scr/fongsu/.cache/Dahoas___parquet/Dahoas--synthetic-instruct-gptj-pairwise-0b2fd7bd9ea121cb/0.0.0/2a3b91fbd88a2c90d1dbbb32b460cf621d31bd5b05b934492fdef7d8d6f236ec)
04/21/2023 11:23:08 - WARNING - datasets.builder - Using custom data configuration Dahoas--synthetic-instruct-gptj-pairwise-0b2fd7bd9ea121cb
04/21/2023 11:23:08 - WARNING - datasets.builder - Found cached dataset parquet (/nlp/scr/fongsu/.cache/Dahoas___parquet/Dahoas--synthetic-instruct-gptj-pairwise-0b2fd7bd9ea121cb/0.0.0/2a3b91fbd88a2c90d1dbbb32b460cf621d31bd5b05b934492fdef7d8d6f236ec)
[2023-04-21 11:23:17,410] [INFO] [launch.py:428:sigkill_handler] Killing subprocess 2367164
[2023-04-21 11:23:17,410] [INFO] [launch.py:428:sigkill_handler] Killing subprocess 2367165
[2023-04-21 11:23:17,463] [INFO] [launch.py:428:sigkill_handler] Killing subprocess 2367166
[2023-04-21 11:23:17,489] [INFO] [launch.py:428:sigkill_handler] Killing subprocess 2367167
[2023-04-21 11:23:17,499] [ERROR] [launch.py:434:sigkill_handler] ['/sailhome/fongsu/rm/bin/python', '-u', 'src/reward_modelling/reward_model.py', '--local_rank=3', '--model_name_or_path=EleutherAI/gpt-neo-1.3B', '--output_dir=/nlp/scr/fongsu/reward_model_HH/train_first_half/', '--logging_steps=10', '--per_device_train_batch_size=16', '--per_device_eval_batch_size=16', '--num_train_epochs=1', '--do_eval=True', '--evaluation_strategy=steps', '--eval_steps=1000', '--save_total_limit=5', '--save_strategy=steps', '--save_steps=1000', '--learning_rate=1e-5', '--weight_decay=0.001', '--report_to=wandb', '--gradient_checkpointing=True', '--ddp_find_unused_parameters=False', '--push_to_hub=True'] exits with return code = 1
