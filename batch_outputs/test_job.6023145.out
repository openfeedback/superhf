SLURM_JOBID=6023145
SLURM_JOB_NODELIST=jagupard35
SLURM_NNODES=1
SLURMTMPDIR=
working directory = /sailhome/fongsu/superhf
[2023-04-15 02:00:42,933] [WARNING] [runner.py:190:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
Detected CUDA_VISIBLE_DEVICES=0,1,2,3: setting --include=localhost:0,1,2,3
[2023-04-15 02:00:42,965] [INFO] [runner.py:540:main] cmd = /sailhome/fongsu/rm/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMSwgMiwgM119 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None src/reward_modelling/reward_model.py --output_dir .
[2023-04-15 02:00:45,193] [INFO] [launch.py:222:main] 0 NCCL_P2P_DISABLE=1
[2023-04-15 02:00:45,193] [INFO] [launch.py:229:main] WORLD INFO DICT: {'localhost': [0, 1, 2, 3]}
[2023-04-15 02:00:45,193] [INFO] [launch.py:235:main] nnodes=1, num_local_procs=4, node_rank=0
[2023-04-15 02:00:45,193] [INFO] [launch.py:246:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3]})
[2023-04-15 02:00:45,193] [INFO] [launch.py:247:main] dist_world_size=4
[2023-04-15 02:00:45,193] [INFO] [launch.py:249:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3
04/15/2023 02:02:06 - WARNING - datasets.builder - Using custom data configuration Dahoas--synthetic-instruct-gptj-pairwise-0b2fd7bd9ea121cb
Downloading and preparing dataset None/None (download: 17.38 MiB, generated: 29.92 MiB, post-processed: Unknown size, total: 47.30 MiB) to /nlp/scr/fongsu/.cache/Dahoas___parquet/Dahoas--synthetic-instruct-gptj-pairwise-0b2fd7bd9ea121cb/0.0.0/2a3b91fbd88a2c90d1dbbb32b460cf621d31bd5b05b934492fdef7d8d6f236ec...
Dataset parquet downloaded and prepared to /nlp/scr/fongsu/.cache/Dahoas___parquet/Dahoas--synthetic-instruct-gptj-pairwise-0b2fd7bd9ea121cb/0.0.0/2a3b91fbd88a2c90d1dbbb32b460cf621d31bd5b05b934492fdef7d8d6f236ec. Subsequent calls will reuse this data.
04/15/2023 02:02:09 - WARNING - datasets.builder - Using custom data configuration Dahoas--synthetic-instruct-gptj-pairwise-0b2fd7bd9ea121cb
04/15/2023 02:02:09 - INFO - datasets.builder - Overwrite dataset info from restored data version.
04/15/2023 02:02:09 - INFO - datasets.info - Loading Dataset info from /nlp/scr/fongsu/.cache/Dahoas___parquet/Dahoas--synthetic-instruct-gptj-pairwise-0b2fd7bd9ea121cb/0.0.0/2a3b91fbd88a2c90d1dbbb32b460cf621d31bd5b05b934492fdef7d8d6f236ec
04/15/2023 02:02:09 - WARNING - datasets.builder - Found cached dataset parquet (/nlp/scr/fongsu/.cache/Dahoas___parquet/Dahoas--synthetic-instruct-gptj-pairwise-0b2fd7bd9ea121cb/0.0.0/2a3b91fbd88a2c90d1dbbb32b460cf621d31bd5b05b934492fdef7d8d6f236ec)
04/15/2023 02:02:09 - INFO - datasets.info - Loading Dataset info from /nlp/scr/fongsu/.cache/Dahoas___parquet/Dahoas--synthetic-instruct-gptj-pairwise-0b2fd7bd9ea121cb/0.0.0/2a3b91fbd88a2c90d1dbbb32b460cf621d31bd5b05b934492fdef7d8d6f236ec
04/15/2023 02:02:09 - WARNING - datasets.builder - Using custom data configuration Dahoas--synthetic-instruct-gptj-pairwise-0b2fd7bd9ea121cb
04/15/2023 02:02:09 - WARNING - datasets.builder - Found cached dataset parquet (/nlp/scr/fongsu/.cache/Dahoas___parquet/Dahoas--synthetic-instruct-gptj-pairwise-0b2fd7bd9ea121cb/0.0.0/2a3b91fbd88a2c90d1dbbb32b460cf621d31bd5b05b934492fdef7d8d6f236ec)
04/15/2023 02:02:11 - WARNING - datasets.builder - Using custom data configuration Dahoas--synthetic-instruct-gptj-pairwise-0b2fd7bd9ea121cb
04/15/2023 02:02:11 - WARNING - datasets.builder - Found cached dataset parquet (/nlp/scr/fongsu/.cache/Dahoas___parquet/Dahoas--synthetic-instruct-gptj-pairwise-0b2fd7bd9ea121cb/0.0.0/2a3b91fbd88a2c90d1dbbb32b460cf621d31bd5b05b934492fdef7d8d6f236ec)
04/15/2023 02:02:15 - WARNING - huggingface_hub.repository - Cloning https://huggingface.co/oliversssf2/gptneo-1.3B-rm-instructgpt into local empty directory.
{'loss': 0.3126, 'learning_rate': 9.951737451737453e-06, 'epoch': 0.0}
{'loss': 0.1707, 'learning_rate': 9.903474903474905e-06, 'epoch': 0.01}
{'loss': 0.1128, 'learning_rate': 9.855212355212356e-06, 'epoch': 0.01}
{'loss': 0.0432, 'learning_rate': 9.806949806949808e-06, 'epoch': 0.02}
{'loss': 0.0206, 'learning_rate': 9.75868725868726e-06, 'epoch': 0.02}
{'loss': 0.0171, 'learning_rate': 9.71042471042471e-06, 'epoch': 0.03}
{'loss': 0.0063, 'learning_rate': 9.662162162162164e-06, 'epoch': 0.03}
{'loss': 0.0042, 'learning_rate': 9.613899613899614e-06, 'epoch': 0.04}
{'loss': 0.0381, 'learning_rate': 9.565637065637067e-06, 'epoch': 0.04}
{'loss': 0.0074, 'learning_rate': 9.517374517374518e-06, 'epoch': 0.05}
{'loss': 0.0056, 'learning_rate': 9.469111969111971e-06, 'epoch': 0.05}
{'loss': 0.0621, 'learning_rate': 9.420849420849421e-06, 'epoch': 0.06}
{'loss': 0.0047, 'learning_rate': 9.372586872586873e-06, 'epoch': 0.06}
{'loss': 0.0016, 'learning_rate': 9.324324324324325e-06, 'epoch': 0.07}
{'loss': 0.0295, 'learning_rate': 9.276061776061777e-06, 'epoch': 0.07}
{'loss': 0.0022, 'learning_rate': 9.227799227799229e-06, 'epoch': 0.08}
{'loss': 0.0067, 'learning_rate': 9.17953667953668e-06, 'epoch': 0.08}
{'loss': 0.0016, 'learning_rate': 9.13127413127413e-06, 'epoch': 0.09}
{'loss': 0.0116, 'learning_rate': 9.083011583011584e-06, 'epoch': 0.09}
{'loss': 0.0032, 'learning_rate': 9.034749034749034e-06, 'epoch': 0.1}
[2023-04-15 02:11:23,893] [INFO] [launch.py:428:sigkill_handler] Killing subprocess 1760826
[2023-04-15 02:11:24,379] [INFO] [launch.py:428:sigkill_handler] Killing subprocess 1760827
[2023-04-15 02:11:24,393] [INFO] [launch.py:428:sigkill_handler] Killing subprocess 1760828
[2023-04-15 02:11:24,393] [INFO] [launch.py:428:sigkill_handler] Killing subprocess 1760829
[2023-04-15 02:11:24,400] [ERROR] [launch.py:434:sigkill_handler] ['/sailhome/fongsu/rm/bin/python', '-u', 'src/reward_modelling/reward_model.py', '--local_rank=3', '--output_dir', '.'] exits with return code = 1
