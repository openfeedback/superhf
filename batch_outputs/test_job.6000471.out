SLURM_JOBID=6000471
SLURM_JOB_NODELIST=jagupard35
SLURM_NNODES=1
SLURMTMPDIR=
working directory = /sailhome/fongsu/superhf
[2023-04-04 23:27:14,519] [WARNING] [runner.py:186:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
Detected CUDA_VISIBLE_DEVICES=0 but ignoring it because one or several of --include/--exclude/--num_gpus/--num_nodes cl args were used. If you want to use CUDA_VISIBLE_DEVICES don't pass any of these arguments to deepspeed.
[2023-04-04 23:27:14,558] [INFO] [runner.py:548:main] cmd = /sailhome/fongsu/rm/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None src/reward_modelling/reward_model.py --deepspeed src/reward_modelling/ds_configs/stage_3_config.json
[2023-04-04 23:27:16,431] [INFO] [launch.py:135:main] 0 NCCL_P2P_DISABLE=1
[2023-04-04 23:27:16,431] [INFO] [launch.py:142:main] WORLD INFO DICT: {'localhost': [0]}
[2023-04-04 23:27:16,431] [INFO] [launch.py:148:main] nnodes=1, num_local_procs=1, node_rank=0
[2023-04-04 23:27:16,431] [INFO] [launch.py:161:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2023-04-04 23:27:16,431] [INFO] [launch.py:162:main] dist_world_size=1
[2023-04-04 23:27:16,431] [INFO] [launch.py:164:main] Setting CUDA_VISIBLE_DEVICES=0
{'loss': 0.6919, 'learning_rate': 9.927007299270073e-06, 'epoch': 0.01}
{'loss': 0.6829, 'learning_rate': 9.854014598540148e-06, 'epoch': 0.01}
{'loss': 0.6768, 'learning_rate': 9.78102189781022e-06, 'epoch': 0.02}
{'loss': 0.6726, 'learning_rate': 9.708029197080293e-06, 'epoch': 0.03}
{'loss': 0.6354, 'learning_rate': 9.635036496350367e-06, 'epoch': 0.04}
{'loss': 0.63, 'learning_rate': 9.56204379562044e-06, 'epoch': 0.04}
{'loss': 0.655, 'learning_rate': 9.48905109489051e-06, 'epoch': 0.05}
{'loss': 0.6335, 'learning_rate': 9.416058394160585e-06, 'epoch': 0.06}
{'loss': 0.6401, 'learning_rate': 9.343065693430657e-06, 'epoch': 0.07}
{'loss': 0.625, 'learning_rate': 9.27007299270073e-06, 'epoch': 0.07}
{'loss': 0.6492, 'learning_rate': 9.197080291970804e-06, 'epoch': 0.08}
{'loss': 0.6486, 'learning_rate': 9.124087591240877e-06, 'epoch': 0.09}
{'loss': 0.6401, 'learning_rate': 9.05109489051095e-06, 'epoch': 0.09}
{'loss': 0.6062, 'learning_rate': 8.978102189781024e-06, 'epoch': 0.1}
{'loss': 0.627, 'learning_rate': 8.905109489051096e-06, 'epoch': 0.11}
{'loss': 0.63, 'learning_rate': 8.832116788321169e-06, 'epoch': 0.12}
{'loss': 0.6316, 'learning_rate': 8.759124087591241e-06, 'epoch': 0.12}
{'loss': 0.6373, 'learning_rate': 8.686131386861315e-06, 'epoch': 0.13}
{'loss': 0.6388, 'learning_rate': 8.613138686131386e-06, 'epoch': 0.14}
{'loss': 0.6374, 'learning_rate': 8.54014598540146e-06, 'epoch': 0.15}
{'eval_loss': 0.6277196407318115, 'eval_accuracy': 0.635089209855565, 'eval_runtime': 17.6523, 'eval_samples_per_second': 133.354, 'eval_steps_per_second': 4.192, 'epoch': 0.15}
{'loss': 0.6142, 'learning_rate': 8.467153284671533e-06, 'epoch': 0.15}
{'loss': 0.617, 'learning_rate': 8.394160583941606e-06, 'epoch': 0.16}
{'loss': 0.6398, 'learning_rate': 8.32116788321168e-06, 'epoch': 0.17}
{'loss': 0.5822, 'learning_rate': 8.248175182481753e-06, 'epoch': 0.18}
{'loss': 0.6193, 'learning_rate': 8.175182481751825e-06, 'epoch': 0.18}
{'loss': 0.6442, 'learning_rate': 8.1021897810219e-06, 'epoch': 0.19}
{'loss': 0.6295, 'learning_rate': 8.029197080291972e-06, 'epoch': 0.2}
{'loss': 0.6011, 'learning_rate': 7.956204379562045e-06, 'epoch': 0.2}
{'loss': 0.6342, 'learning_rate': 7.883211678832117e-06, 'epoch': 0.21}
{'loss': 0.6212, 'learning_rate': 7.810218978102191e-06, 'epoch': 0.22}
{'loss': 0.6213, 'learning_rate': 7.737226277372264e-06, 'epoch': 0.23}
{'loss': 0.6329, 'learning_rate': 7.664233576642336e-06, 'epoch': 0.23}
{'loss': 0.6546, 'learning_rate': 7.591240875912409e-06, 'epoch': 0.24}
{'loss': 0.6069, 'learning_rate': 7.5182481751824825e-06, 'epoch': 0.25}
{'loss': 0.6417, 'learning_rate': 7.445255474452555e-06, 'epoch': 0.26}
{'loss': 0.6041, 'learning_rate': 7.3722627737226285e-06, 'epoch': 0.26}
{'loss': 0.6055, 'learning_rate': 7.299270072992701e-06, 'epoch': 0.27}
{'loss': 0.6057, 'learning_rate': 7.2262773722627744e-06, 'epoch': 0.28}
{'loss': 0.6097, 'learning_rate': 7.153284671532848e-06, 'epoch': 0.28}
{'loss': 0.6058, 'learning_rate': 7.08029197080292e-06, 'epoch': 0.29}
{'eval_loss': 0.6215174198150635, 'eval_accuracy': 0.6461342395921835, 'eval_runtime': 17.6323, 'eval_samples_per_second': 133.505, 'eval_steps_per_second': 4.197, 'epoch': 0.29}
{'loss': 0.6562, 'learning_rate': 7.007299270072994e-06, 'epoch': 0.3}
{'loss': 0.6101, 'learning_rate': 6.934306569343066e-06, 'epoch': 0.31}
{'loss': 0.628, 'learning_rate': 6.86131386861314e-06, 'epoch': 0.31}
{'loss': 0.5993, 'learning_rate': 6.7883211678832115e-06, 'epoch': 0.32}
{'loss': 0.6402, 'learning_rate': 6.715328467153285e-06, 'epoch': 0.33}
{'loss': 0.6161, 'learning_rate': 6.6423357664233575e-06, 'epoch': 0.34}
{'loss': 0.6192, 'learning_rate': 6.569343065693431e-06, 'epoch': 0.34}
{'loss': 0.6031, 'learning_rate': 6.496350364963504e-06, 'epoch': 0.35}
{'loss': 0.6346, 'learning_rate': 6.423357664233577e-06, 'epoch': 0.36}
{'loss': 0.633, 'learning_rate': 6.35036496350365e-06, 'epoch': 0.36}
{'loss': 0.619, 'learning_rate': 6.277372262773723e-06, 'epoch': 0.37}
{'loss': 0.6084, 'learning_rate': 6.204379562043796e-06, 'epoch': 0.38}
{'loss': 0.634, 'learning_rate': 6.13138686131387e-06, 'epoch': 0.39}
{'loss': 0.6034, 'learning_rate': 6.058394160583942e-06, 'epoch': 0.39}
{'loss': 0.5956, 'learning_rate': 5.985401459854016e-06, 'epoch': 0.4}
{'loss': 0.6243, 'learning_rate': 5.912408759124088e-06, 'epoch': 0.41}
{'loss': 0.6576, 'learning_rate': 5.839416058394161e-06, 'epoch': 0.42}
{'loss': 0.6001, 'learning_rate': 5.766423357664233e-06, 'epoch': 0.42}
{'loss': 0.6535, 'learning_rate': 5.693430656934307e-06, 'epoch': 0.43}
{'loss': 0.6061, 'learning_rate': 5.62043795620438e-06, 'epoch': 0.44}
{'eval_loss': 0.6115076541900635, 'eval_accuracy': 0.6542056074766355, 'eval_runtime': 17.6061, 'eval_samples_per_second': 133.703, 'eval_steps_per_second': 4.203, 'epoch': 0.44}
{'loss': 0.5868, 'learning_rate': 5.547445255474453e-06, 'epoch': 0.45}
{'loss': 0.6125, 'learning_rate': 5.474452554744526e-06, 'epoch': 0.45}
{'loss': 0.6047, 'learning_rate': 5.401459854014599e-06, 'epoch': 0.46}
{'loss': 0.6542, 'learning_rate': 5.328467153284672e-06, 'epoch': 0.47}
{'loss': 0.6025, 'learning_rate': 5.255474452554746e-06, 'epoch': 0.47}
{'loss': 0.594, 'learning_rate': 5.182481751824818e-06, 'epoch': 0.48}
{'loss': 0.6076, 'learning_rate': 5.1094890510948916e-06, 'epoch': 0.49}
{'loss': 0.6033, 'learning_rate': 5.036496350364964e-06, 'epoch': 0.5}
{'loss': 0.6492, 'learning_rate': 4.963503649635037e-06, 'epoch': 0.5}
{'loss': 0.5923, 'learning_rate': 4.89051094890511e-06, 'epoch': 0.51}
{'loss': 0.5797, 'learning_rate': 4.8175182481751835e-06, 'epoch': 0.52}
{'loss': 0.6158, 'learning_rate': 4.744525547445255e-06, 'epoch': 0.53}
{'loss': 0.6088, 'learning_rate': 4.671532846715329e-06, 'epoch': 0.53}
{'loss': 0.6098, 'learning_rate': 4.598540145985402e-06, 'epoch': 0.54}
{'loss': 0.6059, 'learning_rate': 4.525547445255475e-06, 'epoch': 0.55}
{'loss': 0.5888, 'learning_rate': 4.452554744525548e-06, 'epoch': 0.55}
{'loss': 0.6402, 'learning_rate': 4.379562043795621e-06, 'epoch': 0.56}
{'loss': 0.5932, 'learning_rate': 4.306569343065693e-06, 'epoch': 0.57}
{'loss': 0.5973, 'learning_rate': 4.233576642335767e-06, 'epoch': 0.58}
{'loss': 0.6046, 'learning_rate': 4.16058394160584e-06, 'epoch': 0.58}
{'eval_loss': 0.6069274544715881, 'eval_accuracy': 0.6529311809685642, 'eval_runtime': 17.6204, 'eval_samples_per_second': 133.595, 'eval_steps_per_second': 4.2, 'epoch': 0.58}
{'loss': 0.6003, 'learning_rate': 4.0875912408759126e-06, 'epoch': 0.59}
{'loss': 0.6087, 'learning_rate': 4.014598540145986e-06, 'epoch': 0.6}
{'loss': 0.5783, 'learning_rate': 3.9416058394160585e-06, 'epoch': 0.61}
{'loss': 0.6219, 'learning_rate': 3.868613138686132e-06, 'epoch': 0.61}
{'loss': 0.5947, 'learning_rate': 3.7956204379562045e-06, 'epoch': 0.62}
{'loss': 0.6097, 'learning_rate': 3.7226277372262775e-06, 'epoch': 0.63}
{'loss': 0.6237, 'learning_rate': 3.6496350364963505e-06, 'epoch': 0.64}
{'loss': 0.627, 'learning_rate': 3.576642335766424e-06, 'epoch': 0.64}
{'loss': 0.607, 'learning_rate': 3.503649635036497e-06, 'epoch': 0.65}
{'loss': 0.6424, 'learning_rate': 3.43065693430657e-06, 'epoch': 0.66}
{'loss': 0.6364, 'learning_rate': 3.3576642335766425e-06, 'epoch': 0.66}
{'loss': 0.5951, 'learning_rate': 3.2846715328467155e-06, 'epoch': 0.67}
{'loss': 0.639, 'learning_rate': 3.2116788321167884e-06, 'epoch': 0.68}
{'loss': 0.6115, 'learning_rate': 3.1386861313868614e-06, 'epoch': 0.69}
{'loss': 0.5987, 'learning_rate': 3.065693430656935e-06, 'epoch': 0.69}
{'loss': 0.6291, 'learning_rate': 2.992700729927008e-06, 'epoch': 0.7}
{'loss': 0.6018, 'learning_rate': 2.9197080291970804e-06, 'epoch': 0.71}
{'loss': 0.6054, 'learning_rate': 2.8467153284671534e-06, 'epoch': 0.72}
{'loss': 0.59, 'learning_rate': 2.7737226277372264e-06, 'epoch': 0.72}
{'loss': 0.6199, 'learning_rate': 2.7007299270072994e-06, 'epoch': 0.73}
{'eval_loss': 0.6041065454483032, 'eval_accuracy': 0.6550552251486831, 'eval_runtime': 17.6144, 'eval_samples_per_second': 133.64, 'eval_steps_per_second': 4.201, 'epoch': 0.73}
{'loss': 0.6071, 'learning_rate': 2.627737226277373e-06, 'epoch': 0.74}
{'loss': 0.617, 'learning_rate': 2.5547445255474458e-06, 'epoch': 0.74}
{'loss': 0.6081, 'learning_rate': 2.4817518248175183e-06, 'epoch': 0.75}
{'loss': 0.5673, 'learning_rate': 2.4087591240875918e-06, 'epoch': 0.76}
{'loss': 0.5979, 'learning_rate': 2.3357664233576643e-06, 'epoch': 0.77}
{'loss': 0.6172, 'learning_rate': 2.2627737226277373e-06, 'epoch': 0.77}
{'loss': 0.6503, 'learning_rate': 2.1897810218978103e-06, 'epoch': 0.78}
{'loss': 0.623, 'learning_rate': 2.1167883211678833e-06, 'epoch': 0.79}
{'loss': 0.616, 'learning_rate': 2.0437956204379563e-06, 'epoch': 0.8}
{'loss': 0.5875, 'learning_rate': 1.9708029197080293e-06, 'epoch': 0.8}
{'loss': 0.6235, 'learning_rate': 1.8978102189781023e-06, 'epoch': 0.81}
{'loss': 0.6273, 'learning_rate': 1.8248175182481753e-06, 'epoch': 0.82}
{'loss': 0.6293, 'learning_rate': 1.7518248175182485e-06, 'epoch': 0.82}
{'loss': 0.5677, 'learning_rate': 1.6788321167883212e-06, 'epoch': 0.83}
{'loss': 0.6217, 'learning_rate': 1.6058394160583942e-06, 'epoch': 0.84}
{'loss': 0.5934, 'learning_rate': 1.5328467153284674e-06, 'epoch': 0.85}
{'loss': 0.5897, 'learning_rate': 1.4598540145985402e-06, 'epoch': 0.85}
{'loss': 0.6306, 'learning_rate': 1.3868613138686132e-06, 'epoch': 0.86}
{'loss': 0.6282, 'learning_rate': 1.3138686131386864e-06, 'epoch': 0.87}
{'loss': 0.6046, 'learning_rate': 1.2408759124087592e-06, 'epoch': 0.88}
{'eval_loss': 0.6039333939552307, 'eval_accuracy': 0.6584536958368734, 'eval_runtime': 17.5889, 'eval_samples_per_second': 133.834, 'eval_steps_per_second': 4.207, 'epoch': 0.88}
{'loss': 0.5937, 'learning_rate': 1.1678832116788322e-06, 'epoch': 0.88}
{'loss': 0.661, 'learning_rate': 1.0948905109489052e-06, 'epoch': 0.89}
{'loss': 0.6109, 'learning_rate': 1.0218978102189781e-06, 'epoch': 0.9}
{'loss': 0.5698, 'learning_rate': 9.489051094890511e-07, 'epoch': 0.91}
{'loss': 0.6254, 'learning_rate': 8.759124087591242e-07, 'epoch': 0.91}
{'loss': 0.6312, 'learning_rate': 8.029197080291971e-07, 'epoch': 0.92}
{'loss': 0.6257, 'learning_rate': 7.299270072992701e-07, 'epoch': 0.93}
{'loss': 0.6193, 'learning_rate': 6.569343065693432e-07, 'epoch': 0.93}
{'loss': 0.6311, 'learning_rate': 5.839416058394161e-07, 'epoch': 0.94}
{'loss': 0.6041, 'learning_rate': 5.109489051094891e-07, 'epoch': 0.95}
{'loss': 0.6051, 'learning_rate': 4.379562043795621e-07, 'epoch': 0.96}
{'loss': 0.5693, 'learning_rate': 3.6496350364963505e-07, 'epoch': 0.96}
{'loss': 0.6237, 'learning_rate': 2.9197080291970804e-07, 'epoch': 0.97}
{'loss': 0.6001, 'learning_rate': 2.1897810218978106e-07, 'epoch': 0.98}
{'loss': 0.5919, 'learning_rate': 1.4598540145985402e-07, 'epoch': 0.99}
{'loss': 0.63, 'learning_rate': 7.299270072992701e-08, 'epoch': 0.99}
{'loss': 0.5982, 'learning_rate': 0.0, 'epoch': 1.0}
{'train_runtime': 1078.4527, 'train_samples_per_second': 40.646, 'train_steps_per_second': 1.27, 'train_loss': 0.6183323160575254, 'epoch': 1.0}
[2023-04-04 23:45:47,581] [INFO] [launch.py:318:sigkill_handler] Killing subprocess 391494
[2023-04-04 23:45:47,582] [ERROR] [launch.py:324:sigkill_handler] ['/sailhome/fongsu/rm/bin/python', '-u', 'src/reward_modelling/reward_model.py', '--local_rank=0', '--deepspeed', 'src/reward_modelling/ds_configs/stage_3_config.json'] exits with return code = 1
